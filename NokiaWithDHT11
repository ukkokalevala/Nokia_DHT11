#include <ESP8266WiFi.h>
#include <Adafruit_GFX.h>
#include <Adafruit_PCD8544.h>
#include <DHT.h>

#define DHTPIN D4     // Pin where the DHT11 is connected
#define DHTTYPE DHT11 // Define the type of DHT sensor

DHT dht(DHTPIN, DHTTYPE);

// Nokia 5110 Display Pins
#define CLK D1
#define DIN D2
#define DC  D5
#define CE  D6
#define RST D7

Adafruit_PCD8544 display = Adafruit_PCD8544(CLK, DIN, DC, CE, RST);

void setup() {
  Serial.begin(115200);

  // Initialize DHT sensor
  dht.begin();

  // Initialize Nokia 5110 display
  display.begin();
  display.setContrast(50); // Adjust as needed for readability
  display.setRotation(2);  // Rotate display by 180 degrees if needed
  display.clearDisplay();
  display.display();
}

void loop() {
  // Reading temperature and humidity from DHT11
  float humidity = dht.readHumidity();
  float temperature = dht.readTemperature();

  // Check if the readings are valid
  if (isnan(humidity) || isnan(temperature)) {
    Serial.println("Failed to read from DHT sensor!");
    return;
  }

  // Display data on the Nokia 5110 display
  display.clearDisplay();
  display.setTextSize(1);
  display.setTextColor(BLACK);
  
  // Display temperature
  display.setCursor(0, 0);
  display.println("Temp:");
  display.setTextSize(1);  // Bigger font for temperature
  display.print(temperature);
  display.println(" C");
  
  // Display humidity
  display.setTextSize(1);  // Smaller font for humidity
  display.setCursor(0, 20);
  display.println("Humidity:");
  display.setTextSize(1);  // Bigger font for humidity
  display.print(humidity);
  display.println(" %");

  display.display();

  // Update every 2 seconds
  delay(2000);
}
